#!/usr/bin/env php
<?php

$checkDirs = ['/../../', '/../', '/../../../../'];

foreach ($checkDirs as $checkDir) {
    $autoloadFile = __DIR__ . $checkDir . '/vendor/autoload.php';
    if (file_exists($autoloadFile)) {
        require $autoloadFile;
        break;
    }
}

use Fiddler\Compiler;

error_reporting(-1);
ini_set('display_errors', 1);

try {
    $compiler = new Compiler();
    $compiler->compile();

    echo 'Compiled phar: fiddler.phar';
} catch (\Exception $e) {
    echo 'Failed to compile phar: ['.get_class($e).'] '.$e->getMessage().' at '.$e->getFile().':'.$e->getLine();
    exit(1);
}

